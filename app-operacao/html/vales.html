<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vales</title>

  <link rel="manifest" href="../manifest.json" />
  <link rel="icon" href="../../common/img/favicon.ico" />
  <meta name="theme-color" content="#6a1b9a" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- scripts globais -->
  <script type="module" src="../../common/js/navegacao.js"></script>
  <script defer src="../../common/js/toast.js"></script>
  <script type="module" src="../js/sync.js"></script>
  <script type="module" src="../js/vales.js?v=2025-09-13-1"></script>

  <style>
    /* === mantém teu estilo original === */
    body { font-family: Arial, sans-serif; margin: 0; background: #f5f5f5; }
    main { padding: 16px; }
    h2 { text-align: center; margin-top: 8px; color: #6a1b9a; }
    label { font-weight: bold; display: block; margin-top: 10px; }
    input, select {
      width: 100%; padding: 8px; border: none; border-bottom: 2px solid #ccc;
      background: transparent; font-size: 16px; margin-bottom: 12px;
    }
    input:focus, select:focus { outline: none; border-bottom: 2px solid #6a1b9a; }
    .btn {
      background: #6a1b9a; color: white; padding: 12px; width: 100%;
      border: none; border-radius: 6px; font-size: 16px; cursor: pointer; margin-top: 10px;
    }
    .btn:hover { background: #4a137a; }
    .btn-outline { background: #fff; color:#6a1b9a; border: 1px solid #6a1b9a; }
    .resumo { margin-top: 20px; background: white; padding: 12px; border-radius: 8px; box-shadow: 0 0 4px rgba(0,0,0,0.1); }
    .resumo-box {
      background: #fff; padding: 1rem; border-radius: 8px; margin-top: 1rem;
      font-size: 15px; line-height: 1.6; box-shadow: 0 0 4px rgba(0,0,0,0.08);
    }
    .positivo { color: green; font-weight: bold; }
    .negativo { color: red; font-weight: bold; }
    .zero { color: #000; font-weight: bold; }
    .linha-lancamento { padding: 10px 0; border-bottom: 1px solid #eee; }
    .linha-top { display:flex; justify-content:space-between; gap:12px; align-items:center; }
    .acoes { display: flex; gap: 10px; }
    .acoes button { background: transparent; border: none; cursor: pointer; font-size: 18px; padding: 4px 6px; }
    .acoes .editar { color: #6a1b9a; }
    .acoes .excluir { color: #c0392b; }
    .itens-grupo { margin-top:8px; display:none; }
    .itens-grupo.aberto { display:block; }
    .item { display:flex; justify-content:space-between; align-items:center; padding:6px 0; border-bottom:1px dashed #eee; }
    .item small { opacity:.7; }
    #overlayRelatorio { position: fixed; inset: 0; background: rgba(0,0,0,.7); display: none; justify-content: center; align-items: center; padding: env(safe-area-inset-top) 12px env(safe-area-inset-bottom); z-index: 1000; }
    #overlayRelatorio.aberto { display: flex !important; }
    #modalRelatorio {
      background: #fff; border-radius: 12px; width: min(96vw, 1024px);
      max-height: 88dvh; overflow: auto; position: relative; padding: 16px;
      box-shadow: 0 16px 40px rgba(0,0,0,.25); -webkit-overflow-scrolling: touch;
      font-size: 14px; outline: none;
    }
    #btnFecharRelatorio, #btnFecharRelatorio2 {
      border: none; background: #eee; color:#444; padding: 6px 10px; border-radius: 8px; font-weight: 700; cursor: pointer;
    }
    .modal-header { display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:12px; }
    .modal-footer { display:flex; justify-content:flex-end; gap:8px; margin-top:12px; }
    .tabs { display:flex; gap:8px; }
    .tab { border:1px solid #ead7ff; background:#f3e8ff; color:#4c1d95; border-radius:999px; padding:6px 12px; font-weight:700; cursor:pointer; }
    .tab.is-active { background:#6a1b9a; border-color:#6a1b9a; color:#fff; }
    .titulo-relatorio { margin: 6px 2px 10px; font-size: 16px; color:#333; }
    table { width:100%; border-collapse: collapse; }
    th, td { padding: 8px 6px; border-bottom: 1px solid #eee; }
    th { background: #f2f2f7; text-align: left; }
    td.num, th.num { text-align: right; white-space: nowrap; font-variant-numeric: tabular-nums; font-feature-settings: 'tnum' 1; }
    .badge-vencido { color:#c40000; font-weight:700; }
    .badge-avencer { color:#0b8f2c; font-weight:700; }
    @media (max-width: 600px) {
      #overlayRelatorio { padding: 0; align-items: stretch; }
      #modalRelatorio { width: 100vw; max-width: 100vw; height: 100svh; max-height: 100svh; border-radius: 0; padding: 12px; overflow: auto; box-shadow: none; font-size: 15px; }
      table { table-layout: fixed; width: 100%; }
      th:first-child, td:first-child { white-space: normal; }
    }
    @media (min-width: 1200px) { #modalRelatorio { width: 90vw; max-width: 1200px; } }
    #modalRelatorio { padding-bottom: 60px; }
  </style>
</head>
<body>
  <div id="cabecalho"></div>

  <main>
    <h2>Vales</h2>
    <label for="data">Data:</label>
    <input id="data" type="date" />
    <button class="btn" onclick="adicionarEntrada()">+ Novo Vale</button>
    <div id="container-nova-entrada"></div>
    <div id="entradas" class="resumo"></div>
    <div id="resumoVales" class="resumo-box"></div>
    <button type="button" class="btn" onclick="visualizarRelatorio()">Visualizar Relatório</button>
    <button type="button" class="btn btn-outline" onclick="limparVales()">Limpar Registros</button>
  </main>

  <div id="overlayRelatorio" aria-hidden="true">
    <div id="modalRelatorio" tabindex="-1" aria-modal="true" role="dialog">
      <div class="modal-header">
        <div class="tabs" id="tabsSala" hidden>
          <button type="button" class="tab is-active" data-tab="detalhado">Detalhado</button>
          <button type="button" class="tab" data-tab="cliente">Por Cliente</button>
          <button type="button" class="tab" data-tab="autorizacao">Por Autorização</button>
        </div>
        <button id="btnFecharRelatorio" type="button">✕</button>
      </div>
      <h3 id="tituloRelatorio" class="titulo-relatorio"></h3>
      <div id="view-detalhado" class="view"></div>
      <div id="view-cliente" class="view" hidden></div>
      <div id="view-autorizacao" class="view" hidden></div>
      <div id="view-rua" class="view" hidden></div>
      <div class="modal-footer">
        <button id="btnFecharRelatorio2" type="button">Fechar</button>
      </div>
    </div>
  </div>

  <script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("../sw.js", { scope: "../" }).catch(console.error);
  }
  </script>
</body>
</html>
