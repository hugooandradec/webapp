<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Escolher Aplicativo</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./common/img/favicon.ico" />
  <style>
    :root{ --roxo:#6a1b9a; }
    body { margin:0; font-family:Arial,sans-serif; background:#f5f5f5; }
    header {
      background:var(--roxo); color:#fff; padding:12px 16px; font-weight:700;
      display:flex; align-items:center; justify-content:space-between;
    }
    .dot {
      width:10px; height:10px; border-radius:50%; background:#aaa; display:inline-block;
    }
    .container { max-width:420px; margin:48px auto; background:#fff; padding:24px; border-radius:12px; box-shadow:0 4px 16px rgba(0,0,0,.08); }
    .btn {
      display:flex; align-items:center; gap:10px; padding:14px; margin:12px 0;
      background:#fff; border:2px solid var(--roxo); border-radius:10px;
      text-decoration:none; font-weight:700; color:var(--roxo); font-size:16px;
      transition:.2s;
    }
    .btn:hover { background:#f0e6f7; }
    .btn i { color:var(--roxo); }
  </style>
</head>
<body>
  <header>
    <span>Escolher Aplicativo</span>
    <span id="online-dot" class="dot" title="Status de conexão"></span>
  </header>

  <main class="container">
    <a class="btn" href="./app-erp/html/menu.html">
      <i class="fas fa-people-carry"></i> App - ERP
    </a>
    <a class="btn" href="./app-operacao/html/menu.html">
      <i class="fas fa-cogs"></i> App - Operação
    </a>
  </main>

  <script type="module">
    import { isOnline } from "./common/js/navegacao.js";

    // ROOT compatível com GitHub Pages e domínio próprio
    const parts = location.pathname.split("/").filter(Boolean);
    const ROOT = location.hostname.endsWith("github.io") && parts.length > 0 ? "/" + parts[0] + "/" : "/";

    // Registrar o SW da raiz (silencioso)
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register(`${ROOT}sw.js`).catch(() => {});
    }

    // Atualiza o dot de conexão
    async function pintarStatus() {
      const ok = await isOnline();
      const dot = document.getElementById("online-dot");
      if (dot) dot.style.background = ok ? "#16a34a" : "#aaa";
    }
    pintarStatus();
    setInterval(pintarStatus, 30000);
  </script>
</body>
</html>
